Need to refractor the code it's very bad. The problem is that I wrote it a long time ago and I don't remember any of it.
